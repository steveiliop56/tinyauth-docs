import{B as f}from"./index-CQ4oX9Ud.js";var m=Object.create,h=Object.defineProperty,$=Object.getOwnPropertyDescriptor,d=Object.getOwnPropertyNames,o=Object.getPrototypeOf,w=Object.prototype.hasOwnProperty,T=(a,t)=>function(){return t||(0,a[d(a)[0]])((t={exports:{}}).exports,t),t.exports},v=(a,t,l,e)=>{if(t&&typeof t=="object"||typeof t=="function")for(let r of d(t))!w.call(a,r)&&r!==l&&h(a,r,{get:()=>t[r],enumerable:!(e=$(t,r))||e.enumerable});return a},y=(a,t,l)=>(l=a!=null?m(o(a)):{},v(h(l,"default",{value:a,enumerable:!0}),a)),k=T({"../../node_modules/.pnpm/remove-markdown@0.6.2/node_modules/remove-markdown/index.js"(a,t){t.exports=function(l,e){e=e||{},e.listUnicodeChar=e.hasOwnProperty("listUnicodeChar")?e.listUnicodeChar:!1,e.stripListLeaders=e.hasOwnProperty("stripListLeaders")?e.stripListLeaders:!0,e.gfm=e.hasOwnProperty("gfm")?e.gfm:!0,e.useImgAltText=e.hasOwnProperty("useImgAltText")?e.useImgAltText:!0,e.abbr=e.hasOwnProperty("abbr")?e.abbr:!1,e.replaceLinksWithURL=e.hasOwnProperty("replaceLinksWithURL")?e.replaceLinksWithURL:!1,e.htmlTagsToSkip=e.hasOwnProperty("htmlTagsToSkip")?e.htmlTagsToSkip:[],e.throwError=e.hasOwnProperty("throwError")?e.throwError:!1;var r=l||"";r=r.replace(/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/gm,"");try{e.stripListLeaders&&(e.listUnicodeChar?r=r.replace(/^([\s\t]*)([\*\-\+]|\d+\.)\s+/gm,e.listUnicodeChar+" $1"):r=r.replace(/^([\s\t]*)([\*\-\+]|\d+\.)\s+/gm,"$1")),e.gfm&&(r=r.replace(/\n={2,}/g,`
`).replace(/~{3}.*\n/g,"").replace(/~~/g,"").replace(/```(?:.*)\n([\s\S]*?)```/g,(s,c)=>c.trim())),e.abbr&&(r=r.replace(/\*\[.*\]:.*\n/,""));let n=/<[^>]*>/g;if(e.htmlTagsToSkip&&e.htmlTagsToSkip.length>0){const s=e.htmlTagsToSkip.join("|");n=new RegExp(`<(?!/?(${s})(?=>|s[^>]*>))[^>]*>`,"g")}r=r.replace(n,"").replace(/^[=\-]{2,}\s*$/g,"").replace(/\[\^.+?\](\: .*?$)?/g,"").replace(/\s{0,2}\[.*?\]: .*?$/g,"").replace(/\!\[(.*?)\][\[\(].*?[\]\)]/g,e.useImgAltText?"$1":"").replace(/\[([\s\S]*?)\]\s*[\(\[].*?[\)\]]/g,e.replaceLinksWithURL?"$2":"$1").replace(/^(\n)?\s{0,3}>\s?/gm,"$1").replace(/^\s{1,2}\[(.*?)\]: (\S+)( ".*?")?\s*$/g,"").replace(/^(\n)?\s{0,}#{1,6}\s*( (.+))? +#+$|^(\n)?\s{0,}#{1,6}\s*( (.+))?$/gm,"$1$3$4$6").replace(/([\*]+)(\S)(.*?\S)??\1/g,"$2$3").replace(/(^|\W)([_]+)(\S)(.*?\S)??\2($|\W)/g,"$1$3$4$5").replace(/(`{3,})(.*?)\1/gm,"$2").replace(/`(.+?)`/g,"$1").replace(/~(.*?)~/g,"$1")}catch(n){if(e.throwError)throw n;return console.error("remove-markdown encountered error: %s",n),l}return r}}}),x=y(k()),u=new f;function O(a){const t=a.trim();if(!t.startsWith("#"))return"";const e=t.split(`
`)[0]?.trim();return e?(0,x.default)(e,{useImgAltText:!1}):""}async function S(a,t){const{client:l,vectorStoreId:e,tag:r}=t;return a.trim()?(await l.vectorStores.search({query:a,vector_store_identifiers:[e],top_k:10,filters:{key:"generated_metadata.tag",operator:"eq",value:r},search_options:{return_metadata:!0}})).data.flatMap(s=>{const c=s.generated_metadata,i=c.url||"#",_=c.title||"Untitled",p=[{id:`${s.file_id}-${s.chunk_index}-page`,type:"page",content:_,url:i}],g=s.type==="text"?O(s.text):"";return g&&(u.reset(),p.push({id:`${s.file_id}-${s.chunk_index}-heading`,type:"heading",content:g,url:`${i}#${u.slug(g)}`})),p}):[]}export{S as search};
