import{j as e}from"./index-BDrdAJGi.js";const o="/assets/pocket-id-home-DOztcnkK.png",a="/assets/pocket-id-new-client-B5IY6qhg.png",c="/assets/pocket-id-client-page-DFFF-SUD.png",r="/assets/pocket-id-new-group-BIC3yRTT.png",h="/assets/pocket-id-group-home-Cy5VJ1ta.png";let p={title:"Pocket ID OAuth",description:"Use Pocket ID as an OAuth provider in Tinyauth."},g=[{href:"https://pocket-id.org"},{href:"https://pocket-id.org/docs/setup/installation"},{href:"https://github.com/steveiliop56/tinyauth/blob/main/frontend/public/logo.png"},{href:"/docs/reference/configuration"},{href:"./access-controls.md#label-discovery"}],u={contents:[{heading:void 0,content:"Pocket ID is a popular OIDC server that enables login to apps with passkeys. Most proxies do not support OIDC/OAuth servers for authentication, meaning Pocket ID cannot be connected with them. With Tinyauth, Pocket ID can be integrated with proxies to secure apps."},{heading:"requirements",content:"A working Pocket ID installation is required. Refer to Pocket ID's documentation for installation instructions."},{heading:"configuring-pocket-id",content:"Begin by accessing Pocket ID's admin dashboard:"},{heading:"configuring-pocket-id",content:"Navigate to the OIDC Clients tab and click Add OIDC Client. Provide the following details:"},{heading:"configuring-pocket-id",content:"Name"},{heading:"configuring-pocket-id",content:"Value"},{heading:"configuring-pocket-id",content:"Name"},{heading:"configuring-pocket-id",content:"Assign a name to the client, such as Tinyauth."},{heading:"configuring-pocket-id",content:"Callback URLs"},{heading:"configuring-pocket-id",content:"Enter the Tinyauth app URL followed by /api/oauth/callback/pocketid. For example: https://tinyauth.example.com/api/oauth/callback/pocketid."},{heading:"configuring-pocket-id",content:"Optionally, upload a logo for the OIDC client. The Tinyauth logo is available on GitHub."},{heading:"configuring-pocket-id",content:"Click Save. A new page will display the OIDC credentials:"},{heading:"configuring-pocket-id",content:"Note down the client ID and secret for later use."},{heading:"configuring-tinyauth",content:"To integrate Tinyauth with Pocket ID, add the following environment variables to the Tinyauth Docker container:"},{heading:"configuring-tinyauth",content:"type: tip"},{heading:"configuring-tinyauth",content:`Set the OAUTH_AUTO_REDIRECT environment variable to pocketid to enable
automatic redirection to Pocket ID for Tinyauth-protected apps.`},{heading:"configuring-tinyauth",content:"type: warning"},{heading:"configuring-tinyauth",content:`OAuth alone does not guarantee security. By default, any Pocket ID account can
log in as a normal user. To restrict access, use the OAUTH_WHITELIST
environment variable to allow specific email addresses. Refer to the
configuration page for details.`},{heading:"configuring-tinyauth",content:"Restart Tinyauth to apply the changes. The login screen will now include an option to log in with Pocket ID."},{heading:"access-controls-with-pocket-id-groups",content:"Pocket ID supports user groups, which can simplify access control management. To use groups, create one by navigating to the User Groups tab and clicking Add Group. Assign a name and save the group:"},{heading:"access-controls-with-pocket-id-groups",content:"Select users to include in the group:"},{heading:"access-controls-with-pocket-id-groups",content:"Configure Tinyauth-protected apps to require OAuth groups by adding the oauth.groups label:"},{heading:"access-controls-with-pocket-id-groups",content:"In this example, only Pocket ID users in the admin group can access the app. Users outside the group will be redirected to an unauthorized page."},{heading:"access-controls-with-pocket-id-groups",content:"type: warning"},{heading:"access-controls-with-pocket-id-groups",content:`By default, Tinyauth uses the subdomain name of the request to find a matching
container for labels. For example, a request to myapp.example.com checks for
labels in the container named myapp. This behavior can be modified using the
tinyauth.apps.[app].config.domain label. Refer to the access
controls guide for more information.`}],headings:[{id:"requirements",content:"Requirements"},{id:"configuring-pocket-id",content:"Configuring Pocket ID"},{id:"configuring-tinyauth",content:"Configuring Tinyauth"},{id:"access-controls-with-pocket-id-groups",content:"Access Controls with Pocket ID Groups"}]};const k=[{depth:2,url:"#requirements",title:e.jsx(e.Fragment,{children:"Requirements"})},{depth:2,url:"#configuring-pocket-id",title:e.jsx(e.Fragment,{children:"Configuring Pocket ID"})},{depth:2,url:"#configuring-tinyauth",title:e.jsx(e.Fragment,{children:"Configuring Tinyauth"})},{depth:2,url:"#access-controls-with-pocket-id-groups",title:e.jsx(e.Fragment,{children:"Access Controls with Pocket ID Groups"})}];function s(n){const i={a:"a",code:"code",h2:"h2",img:"img",p:"p",pre:"pre",span:"span",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...n.components},{Callout:t}=i;return t||l("Callout"),e.jsxs(e.Fragment,{children:[e.jsxs(i.p,{children:[e.jsx(i.a,{href:"https://pocket-id.org",children:"Pocket ID"})," is a popular OIDC server that enables login to apps with passkeys. Most proxies do not support OIDC/OAuth servers for authentication, meaning Pocket ID cannot be connected with them. With Tinyauth, Pocket ID can be integrated with proxies to secure apps."]}),`
`,e.jsx(i.h2,{id:"requirements",children:"Requirements"}),`
`,e.jsxs(i.p,{children:["A working Pocket ID installation is required. Refer to Pocket ID's ",e.jsx(i.a,{href:"https://pocket-id.org/docs/setup/installation",children:"documentation"})," for installation instructions."]}),`
`,e.jsx(i.h2,{id:"configuring-pocket-id",children:"Configuring Pocket ID"}),`
`,e.jsx(i.p,{children:"Begin by accessing Pocket ID's admin dashboard:"}),`
`,e.jsx(i.p,{children:e.jsx(i.img,{alt:"Pocket ID Admin Page",src:o,placeholder:"blur"})}),`
`,e.jsxs(i.p,{children:["Navigate to the ",e.jsx(i.strong,{children:"OIDC Clients"})," tab and click ",e.jsx(i.strong,{children:"Add OIDC Client"}),". Provide the following details:"]}),`
`,e.jsxs(i.table,{children:[e.jsx(i.thead,{children:e.jsxs(i.tr,{children:[e.jsx(i.th,{children:"Name"}),e.jsx(i.th,{children:"Value"})]})}),e.jsxs(i.tbody,{children:[e.jsxs(i.tr,{children:[e.jsx(i.td,{children:"Name"}),e.jsxs(i.td,{children:["Assign a name to the client, such as ",e.jsx(i.code,{children:"Tinyauth"}),"."]})]}),e.jsxs(i.tr,{children:[e.jsx(i.td,{children:"Callback URLs"}),e.jsxs(i.td,{children:["Enter the Tinyauth app URL followed by ",e.jsx(i.code,{children:"/api/oauth/callback/pocketid"}),". For example: ",e.jsx(i.code,{children:"https://tinyauth.example.com/api/oauth/callback/pocketid"}),"."]})]})]})]}),`
`,e.jsx(i.p,{children:e.jsx(i.img,{alt:"Pocket ID Create Client",src:a,placeholder:"blur"})}),`
`,e.jsxs(i.p,{children:["Optionally, upload a logo for the OIDC client. The Tinyauth logo is available on ",e.jsx(i.a,{href:"https://github.com/steveiliop56/tinyauth/blob/main/frontend/public/logo.png",children:"GitHub"}),"."]}),`
`,e.jsxs(i.p,{children:["Click ",e.jsx(i.strong,{children:"Save"}),". A new page will display the OIDC credentials:"]}),`
`,e.jsx(i.p,{children:e.jsx(i.img,{alt:"Pocket ID Client Page",src:c,placeholder:"blur"})}),`
`,e.jsx(i.p,{children:"Note down the client ID and secret for later use."}),`
`,e.jsx(i.h2,{id:"configuring-tinyauth",children:"Configuring Tinyauth"}),`
`,e.jsx(i.p,{children:"To integrate Tinyauth with Pocket ID, add the following environment variables to the Tinyauth Docker container:"}),`
`,e.jsx(e.Fragment,{children:e.jsx(i.pre,{className:"shiki shiki-themes github-light github-dark",style:{"--shiki-light":"#24292e","--shiki-dark":"#e1e4e8","--shiki-light-bg":"#fff","--shiki-dark-bg":"#24292e"},tabIndex:"0",icon:'<svg viewBox="0 0 24 24"><path d="M 6,1 C 4.354992,1 3,2.354992 3,4 v 16 c 0,1.645008 1.354992,3 3,3 h 12 c 1.645008,0 3,-1.354992 3,-3 V 8 7 A 1.0001,1.0001 0 0 0 20.707031,6.2929687 l -5,-5 A 1.0001,1.0001 0 0 0 15,1 h -1 z m 0,2 h 7 v 3 c 0,1.645008 1.354992,3 3,3 h 3 v 11 c 0,0.564129 -0.435871,1 -1,1 H 6 C 5.4358712,21 5,20.564129 5,20 V 4 C 5,3.4358712 5.4358712,3 6,3 Z M 15,3.4140625 18.585937,7 H 16 C 15.435871,7 15,6.5641288 15,6 Z" fill="currentColor" /></svg>',children:e.jsxs(i.code,{children:[e.jsxs(i.span,{className:"line",children:[e.jsx(i.span,{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"},children:"services"}),e.jsx(i.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:":"})]}),`
`,e.jsxs(i.span,{className:"line",children:[e.jsx(i.span,{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"},children:"  tinyauth"}),e.jsx(i.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:":"})]}),`
`,e.jsxs(i.span,{className:"line",children:[e.jsx(i.span,{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"},children:"    environment"}),e.jsx(i.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:":"})]}),`
`,e.jsxs(i.span,{className:"line",children:[e.jsx(i.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:"      - "}),e.jsx(i.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:"PROVIDERS_POCKETID_CLIENT_ID=your-pocket-id-client-id"})]}),`
`,e.jsxs(i.span,{className:"line",children:[e.jsx(i.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:"      - "}),e.jsx(i.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:"PROVIDERS_POCKETID_CLIENT_SECRET=your-pocket-id-client-secret"})]}),`
`,e.jsxs(i.span,{className:"line",children:[e.jsx(i.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:"      - "}),e.jsx(i.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:"PROVIDERS_POCKETID_AUTH_URL=https://pocket-id.example.com/authorize"})]}),`
`,e.jsxs(i.span,{className:"line",children:[e.jsx(i.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:"      - "}),e.jsx(i.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:"PROVIDERS_POCKETID_TOKEN_URL=https://pocket-id.example.com/api/oidc/token"})]}),`
`,e.jsxs(i.span,{className:"line",children:[e.jsx(i.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:"      - "}),e.jsx(i.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:"PROVIDERS_POCKETID_USER_INFO_URL=https://pocket-id.example.com/api/oidc/userinfo"})]}),`
`,e.jsxs(i.span,{className:"line",children:[e.jsx(i.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:"      - "}),e.jsx(i.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:"PROVIDERS_POCKETID_SCOPES=openid email profile groups"})]}),`
`,e.jsxs(i.span,{className:"line",children:[e.jsx(i.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:"      - "}),e.jsx(i.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:"PROVIDERS_POCKETID_NAME=Pocket ID"})]})]})})}),`
`,e.jsx(t,{type:"tip",children:e.jsxs(i.p,{children:["Set the ",e.jsx(i.code,{children:"OAUTH_AUTO_REDIRECT"})," environment variable to ",e.jsx(i.code,{children:"pocketid"}),` to enable
automatic redirection to Pocket ID for Tinyauth-protected apps.`]})}),`
`,e.jsx(t,{type:"warning",children:e.jsxs(i.p,{children:[`OAuth alone does not guarantee security. By default, any Pocket ID account can
log in as a normal user. To restrict access, use the `,e.jsx(i.code,{children:"OAUTH_WHITELIST"}),`
environment variable to allow specific email addresses. Refer to the
`,e.jsx(i.a,{href:"/docs/reference/configuration",children:"configuration"})," page for details."]})}),`
`,e.jsx(i.p,{children:"Restart Tinyauth to apply the changes. The login screen will now include an option to log in with Pocket ID."}),`
`,e.jsx(i.h2,{id:"access-controls-with-pocket-id-groups",children:"Access Controls with Pocket ID Groups"}),`
`,e.jsxs(i.p,{children:["Pocket ID supports user groups, which can simplify access control management. To use groups, create one by navigating to the ",e.jsx(i.strong,{children:"User Groups"})," tab and clicking ",e.jsx(i.strong,{children:"Add Group"}),". Assign a name and save the group:"]}),`
`,e.jsx(i.p,{children:e.jsx(i.img,{alt:"Pocket ID New Group",src:r,placeholder:"blur"})}),`
`,e.jsx(i.p,{children:"Select users to include in the group:"}),`
`,e.jsx(i.p,{children:e.jsx(i.img,{alt:"Pocket ID Group Home",src:h,placeholder:"blur"})}),`
`,e.jsxs(i.p,{children:["Configure Tinyauth-protected apps to require OAuth groups by adding the ",e.jsx(i.code,{children:"oauth.groups"})," label:"]}),`
`,e.jsx(e.Fragment,{children:e.jsx(i.pre,{className:"shiki shiki-themes github-light github-dark",style:{"--shiki-light":"#24292e","--shiki-dark":"#e1e4e8","--shiki-light-bg":"#fff","--shiki-dark-bg":"#24292e"},tabIndex:"0",icon:'<svg viewBox="0 0 24 24"><path d="M 6,1 C 4.354992,1 3,2.354992 3,4 v 16 c 0,1.645008 1.354992,3 3,3 h 12 c 1.645008,0 3,-1.354992 3,-3 V 8 7 A 1.0001,1.0001 0 0 0 20.707031,6.2929687 l -5,-5 A 1.0001,1.0001 0 0 0 15,1 h -1 z m 0,2 h 7 v 3 c 0,1.645008 1.354992,3 3,3 h 3 v 11 c 0,0.564129 -0.435871,1 -1,1 H 6 C 5.4358712,21 5,20.564129 5,20 V 4 C 5,3.4358712 5.4358712,3 6,3 Z M 15,3.4140625 18.585937,7 H 16 C 15.435871,7 15,6.5641288 15,6 Z" fill="currentColor" /></svg>',children:e.jsx(i.code,{children:e.jsxs(i.span,{className:"line",children:[e.jsx(i.span,{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"},children:"tinyauth.apps.myapp.oauth.groups"}),e.jsx(i.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:": "}),e.jsx(i.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:"admin"})]})})})}),`
`,e.jsxs(i.p,{children:["In this example, only Pocket ID users in the ",e.jsx(i.code,{children:"admin"})," group can access the app. Users outside the group will be redirected to an unauthorized page."]}),`
`,e.jsx(t,{type:"warning",children:e.jsxs(i.p,{children:[`By default, Tinyauth uses the subdomain name of the request to find a matching
container for labels. For example, a request to `,e.jsx(i.code,{children:"myapp.example.com"}),` checks for
labels in the container named `,e.jsx(i.code,{children:"myapp"}),`. This behavior can be modified using the
`,e.jsx(i.code,{children:"tinyauth.apps.[app].config.domain"})," label. Refer to the ",e.jsx(i.a,{href:"./access-controls.md#label-discovery",children:`access
controls`})," guide for more information."]})})]})}function m(n={}){const{wrapper:i}=n.components||{};return i?e.jsx(i,{...n,children:e.jsx(s,{...n})}):s(n)}function l(n,i){throw new Error("Expected component `"+n+"` to be defined: you likely forgot to import, pass, or provide it.")}export{m as default,g as extractedReferences,p as frontmatter,u as structuredData,k as toc};
