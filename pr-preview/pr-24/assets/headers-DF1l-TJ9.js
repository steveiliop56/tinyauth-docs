import{j as e}from"./index-BDrdAJGi.js";let h={title:"Headers",description:"Reference on Tinyauth's header support."},d=[{href:"/docs/guides/access-controls.md#access-controls-using-oidc-groups"},{href:"/docs/guides/access-controls#label-discovery"}],o={contents:[{heading:void 0,content:"Setting headers can be useful for authenticating to apps with the credentials from Tinyauth. While Tinyauth offers some defaults, it also allows setting custom headers that are automatically returned in the authentication server response. This is particularly useful for applications that support header-based authentication, where the app relies on the reverse proxy to provide authentication and user information."},{heading:void 0,content:"type: info"},{heading:void 0,content:`Headers are case-insensitive. For example, both Remote-User and
remote-user are valid.`},{heading:"remote-user",content:"The Remote-User header contains the username of the currently logged-in user. For OAuth providers, the preferred_username claim from the OIDC response is used. If unavailable, a pseudo username is generated using the email address in the format username_domain.com."},{heading:"remote-email",content:"The Remote-Email header contains the email of the currently logged-in user. For username/password authentication, a pseudo email address is created using the username and the configured domain. For OAuth, the email is retrieved from the email claim."},{heading:"remote-name",content:"The Remote-Name header contains the full name of the currently logged-in user. If the name claim is unavailable, a pseudo name is generated using the username or email in formats like User or User (example.com)."},{heading:"remote-groups",content:"The Remote-Groups header contains the groups of the currently logged-in user, retrieved from the groups claim in the OIDC server. These can be used to allow access to specific user groups configured by the OIDC server. More details are available in the OIDC access controls guide."},{heading:"custom-headers",content:"Custom headers can be set using the tinyauth.headers label on any container that uses the Tinyauth middleware. For example:"},{heading:"custom-headers",content:"When authenticating through Tinyauth, the app will receive the my-header header."},{heading:"custom-headers",content:"type: warning"},{heading:"custom-headers",content:`Ensure a list of trusted proxy URLs is configured for the app. Accepting
headers from untrusted proxies can lead to security vulnerabilities.`},{heading:"custom-headers",content:"type: info"},{heading:"custom-headers",content:`By default, Tinyauth uses the subdomain name of the request to find a matching
container for labels. For example, a request to myapp.example.com checks for
labels that have the subdomain as the app ID. This behavior can be modified
using the tinyauth.apps.[app].config.domain label. More details are
available in the access
controls guide.`},{heading:"adding-headers-to-proxy",content:"Configuring the proxy to forward headers ensures they are included in responses. The configuration varies depending on the proxy."},{heading:"traefik",content:"Add the following label to the Tinyauth container:"},{heading:"traefik",content:"Multiple headers can be added as a comma-separated list."},{heading:"caddy",content:"Add the following label to the Caddy configuration:"},{heading:"caddy",content:"Multiple headers are separated by spaces, for example: remote-user remote-name remote-email remote-groups."},{heading:"nginxnginx-proxy-manager",content:"Insert the following lines after the error_page 401 = @tinyauth_login; directive:"},{heading:"nginxnginx-proxy-manager",content:"Additional headers can be added by repeating the steps. For example:"}],headings:[{id:"supported-headers",content:"Supported Headers"},{id:"remote-user",content:"Remote user"},{id:"remote-email",content:"Remote email"},{id:"remote-name",content:"Remote name"},{id:"remote-groups",content:"Remote groups"},{id:"custom-headers",content:"Custom headers"},{id:"adding-headers-to-proxy",content:"Adding Headers to Proxy"},{id:"traefik",content:"Traefik"},{id:"caddy",content:"Caddy"},{id:"nginxnginx-proxy-manager",content:"Nginx/Nginx Proxy Manager"}]};const l=[{depth:2,url:"#supported-headers",title:e.jsx(e.Fragment,{children:"Supported Headers"})},{depth:3,url:"#remote-user",title:e.jsx(e.Fragment,{children:"Remote user"})},{depth:3,url:"#remote-email",title:e.jsx(e.Fragment,{children:"Remote email"})},{depth:3,url:"#remote-name",title:e.jsx(e.Fragment,{children:"Remote name"})},{depth:3,url:"#remote-groups",title:e.jsx(e.Fragment,{children:"Remote groups"})},{depth:3,url:"#custom-headers",title:e.jsx(e.Fragment,{children:"Custom headers"})},{depth:2,url:"#adding-headers-to-proxy",title:e.jsx(e.Fragment,{children:"Adding Headers to Proxy"})},{depth:3,url:"#traefik",title:e.jsx(e.Fragment,{children:"Traefik"})},{depth:3,url:"#caddy",title:e.jsx(e.Fragment,{children:"Caddy"})},{depth:3,url:"#nginxnginx-proxy-manager",title:e.jsx(e.Fragment,{children:"Nginx/Nginx Proxy Manager"})}];function r(s){const i={a:"a",code:"code",h2:"h2",h3:"h3",p:"p",pre:"pre",span:"span",...s.components},{Callout:t}=i;return t||n("Callout"),e.jsxs(e.Fragment,{children:[e.jsx(i.p,{children:"Setting headers can be useful for authenticating to apps with the credentials from Tinyauth. While Tinyauth offers some defaults, it also allows setting custom headers that are automatically returned in the authentication server response. This is particularly useful for applications that support header-based authentication, where the app relies on the reverse proxy to provide authentication and user information."}),`
`,e.jsx(t,{type:"info",children:e.jsxs(i.p,{children:["Headers are case-insensitive. For example, both ",e.jsx(i.code,{children:"Remote-User"}),` and
`,e.jsx(i.code,{children:"remote-user"})," are valid."]})}),`
`,e.jsx(i.h2,{id:"supported-headers",children:"Supported Headers"}),`
`,e.jsx(i.h3,{id:"remote-user",children:"Remote user"}),`
`,e.jsxs(i.p,{children:["The ",e.jsx(i.code,{children:"Remote-User"})," header contains the username of the currently logged-in user. For OAuth providers, the ",e.jsx(i.code,{children:"preferred_username"})," claim from the OIDC response is used. If unavailable, a pseudo username is generated using the email address in the format ",e.jsx(i.code,{children:"username_domain.com"}),"."]}),`
`,e.jsx(i.h3,{id:"remote-email",children:"Remote email"}),`
`,e.jsxs(i.p,{children:["The ",e.jsx(i.code,{children:"Remote-Email"})," header contains the email of the currently logged-in user. For username/password authentication, a pseudo email address is created using the username and the configured domain. For OAuth, the email is retrieved from the ",e.jsx(i.code,{children:"email"})," claim."]}),`
`,e.jsx(i.h3,{id:"remote-name",children:"Remote name"}),`
`,e.jsxs(i.p,{children:["The ",e.jsx(i.code,{children:"Remote-Name"})," header contains the full name of the currently logged-in user. If the ",e.jsx(i.code,{children:"name"})," claim is unavailable, a pseudo name is generated using the username or email in formats like ",e.jsx(i.code,{children:"User"})," or ",e.jsx(i.code,{children:"User (example.com)"}),"."]}),`
`,e.jsx(i.h3,{id:"remote-groups",children:"Remote groups"}),`
`,e.jsxs(i.p,{children:["The ",e.jsx(i.code,{children:"Remote-Groups"})," header contains the groups of the currently logged-in user, retrieved from the ",e.jsx(i.code,{children:"groups"})," claim in the OIDC server. These can be used to allow access to specific user groups configured by the OIDC server. More details are available in the ",e.jsx(i.a,{href:"/docs/guides/access-controls.md#access-controls-using-oidc-groups",children:"OIDC access controls"})," guide."]}),`
`,e.jsx(i.h3,{id:"custom-headers",children:"Custom headers"}),`
`,e.jsxs(i.p,{children:["Custom headers can be set using the ",e.jsx(i.code,{children:"tinyauth.headers"})," label on any container that uses the Tinyauth middleware. For example:"]}),`
`,e.jsx(e.Fragment,{children:e.jsx(i.pre,{className:"shiki shiki-themes github-light github-dark",style:{"--shiki-light":"#24292e","--shiki-dark":"#e1e4e8","--shiki-light-bg":"#fff","--shiki-dark-bg":"#24292e"},tabIndex:"0",icon:'<svg viewBox="0 0 24 24"><path d="M 6,1 C 4.354992,1 3,2.354992 3,4 v 16 c 0,1.645008 1.354992,3 3,3 h 12 c 1.645008,0 3,-1.354992 3,-3 V 8 7 A 1.0001,1.0001 0 0 0 20.707031,6.2929687 l -5,-5 A 1.0001,1.0001 0 0 0 15,1 h -1 z m 0,2 h 7 v 3 c 0,1.645008 1.354992,3 3,3 h 3 v 11 c 0,0.564129 -0.435871,1 -1,1 H 6 C 5.4358712,21 5,20.564129 5,20 V 4 C 5,3.4358712 5.4358712,3 6,3 Z M 15,3.4140625 18.585937,7 H 16 C 15.435871,7 15,6.5641288 15,6 Z" fill="currentColor" /></svg>',children:e.jsx(i.code,{children:e.jsxs(i.span,{className:"line",children:[e.jsx(i.span,{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"},children:"tinyauth.apps.[app].response.headers"}),e.jsx(i.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:": "}),e.jsx(i.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:"my-header=cool"})]})})})}),`
`,e.jsxs(i.p,{children:["When authenticating through Tinyauth, the app will receive the ",e.jsx(i.code,{children:"my-header"})," header."]}),`
`,e.jsx(t,{type:"warning",children:e.jsx(i.p,{children:`Ensure a list of trusted proxy URLs is configured for the app. Accepting
headers from untrusted proxies can lead to security vulnerabilities.`})}),`
`,e.jsx(t,{type:"info",children:e.jsxs(i.p,{children:[`By default, Tinyauth uses the subdomain name of the request to find a matching
container for labels. For example, a request to `,e.jsx(i.code,{children:"myapp.example.com"}),` checks for
labels that have the subdomain as the app ID. This behavior can be modified
using the `,e.jsx(i.code,{children:"tinyauth.apps.[app].config.domain"}),` label. More details are
available in the `,e.jsx(i.a,{href:"/docs/guides/access-controls#label-discovery",children:`access
controls`})," guide."]})}),`
`,e.jsx(i.h2,{id:"adding-headers-to-proxy",children:"Adding Headers to Proxy"}),`
`,e.jsx(i.p,{children:"Configuring the proxy to forward headers ensures they are included in responses. The configuration varies depending on the proxy."}),`
`,e.jsx(i.h3,{id:"traefik",children:"Traefik"}),`
`,e.jsx(i.p,{children:"Add the following label to the Tinyauth container:"}),`
`,e.jsx(e.Fragment,{children:e.jsx(i.pre,{className:"shiki shiki-themes github-light github-dark",style:{"--shiki-light":"#24292e","--shiki-dark":"#e1e4e8","--shiki-light-bg":"#fff","--shiki-dark-bg":"#24292e"},tabIndex:"0",icon:'<svg viewBox="0 0 24 24"><path d="M 6,1 C 4.354992,1 3,2.354992 3,4 v 16 c 0,1.645008 1.354992,3 3,3 h 12 c 1.645008,0 3,-1.354992 3,-3 V 8 7 A 1.0001,1.0001 0 0 0 20.707031,6.2929687 l -5,-5 A 1.0001,1.0001 0 0 0 15,1 h -1 z m 0,2 h 7 v 3 c 0,1.645008 1.354992,3 3,3 h 3 v 11 c 0,0.564129 -0.435871,1 -1,1 H 6 C 5.4358712,21 5,20.564129 5,20 V 4 C 5,3.4358712 5.4358712,3 6,3 Z M 15,3.4140625 18.585937,7 H 16 C 15.435871,7 15,6.5641288 15,6 Z" fill="currentColor" /></svg>',children:e.jsx(i.code,{children:e.jsxs(i.span,{className:"line",children:[e.jsx(i.span,{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"},children:"traefik.http.middlewares.tinyauth.forwardauth.authResponseHeaders"}),e.jsx(i.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:": "}),e.jsx(i.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:"remote-user"}),e.jsx(i.span,{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"},children:" # This can be a comma separated list of more headers you will like to copy like the custom ones you set"})]})})})}),`
`,e.jsx(i.p,{children:"Multiple headers can be added as a comma-separated list."}),`
`,e.jsx(i.h3,{id:"caddy",children:"Caddy"}),`
`,e.jsx(i.p,{children:"Add the following label to the Caddy configuration:"}),`
`,e.jsx(e.Fragment,{children:e.jsx(i.pre,{className:"shiki shiki-themes github-light github-dark",style:{"--shiki-light":"#24292e","--shiki-dark":"#e1e4e8","--shiki-light-bg":"#fff","--shiki-dark-bg":"#24292e"},tabIndex:"0",icon:'<svg viewBox="0 0 24 24"><path d="M 6,1 C 4.354992,1 3,2.354992 3,4 v 16 c 0,1.645008 1.354992,3 3,3 h 12 c 1.645008,0 3,-1.354992 3,-3 V 8 7 A 1.0001,1.0001 0 0 0 20.707031,6.2929687 l -5,-5 A 1.0001,1.0001 0 0 0 15,1 h -1 z m 0,2 h 7 v 3 c 0,1.645008 1.354992,3 3,3 h 3 v 11 c 0,0.564129 -0.435871,1 -1,1 H 6 C 5.4358712,21 5,20.564129 5,20 V 4 C 5,3.4358712 5.4358712,3 6,3 Z M 15,3.4140625 18.585937,7 H 16 C 15.435871,7 15,6.5641288 15,6 Z" fill="currentColor" /></svg>',children:e.jsx(i.code,{children:e.jsxs(i.span,{className:"line",children:[e.jsx(i.span,{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"},children:"caddy.forward_auth.copy_headers"}),e.jsx(i.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:": "}),e.jsx(i.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:"remote-user"})]})})})}),`
`,e.jsxs(i.p,{children:["Multiple headers are separated by spaces, for example: ",e.jsx(i.code,{children:"remote-user remote-name remote-email remote-groups"}),"."]}),`
`,e.jsx(i.h3,{id:"nginxnginx-proxy-manager",children:"Nginx/Nginx Proxy Manager"}),`
`,e.jsxs(i.p,{children:["Insert the following lines after the ",e.jsx(i.code,{children:"error_page 401 = @tinyauth_login;"})," directive:"]}),`
`,e.jsx(e.Fragment,{children:e.jsx(i.pre,{className:"shiki shiki-themes github-light github-dark",style:{"--shiki-light":"#24292e","--shiki-dark":"#e1e4e8","--shiki-light-bg":"#fff","--shiki-dark-bg":"#24292e"},tabIndex:"0",icon:'<svg viewBox="0 0 24 24"><path d="m 4,4 a 1,1 0 0 0 -0.7070312,0.2929687 1,1 0 0 0 0,1.4140625 L 8.5859375,11 3.2929688,16.292969 a 1,1 0 0 0 0,1.414062 1,1 0 0 0 1.4140624,0 l 5.9999998,-6 a 1.0001,1.0001 0 0 0 0,-1.414062 L 4.7070312,4.2929687 A 1,1 0 0 0 4,4 Z m 8,14 a 1,1 0 0 0 -1,1 1,1 0 0 0 1,1 h 8 a 1,1 0 0 0 1,-1 1,1 0 0 0 -1,-1 z" fill="currentColor" /></svg>',children:e.jsxs(i.code,{children:[e.jsxs(i.span,{className:"line",children:[e.jsx(i.span,{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"},children:"auth_request_set"}),e.jsx(i.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:" $tinyauth_remote_user $upstream_http_remote_user;"})]}),`
`,e.jsxs(i.span,{className:"line",children:[e.jsx(i.span,{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"},children:"proxy_set_header"}),e.jsx(i.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:" remote-user"}),e.jsx(i.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:" $tinyauth_remote_user;"})]})]})})}),`
`,e.jsx(i.p,{children:"Additional headers can be added by repeating the steps. For example:"}),`
`,e.jsx(e.Fragment,{children:e.jsx(i.pre,{className:"shiki shiki-themes github-light github-dark",style:{"--shiki-light":"#24292e","--shiki-dark":"#e1e4e8","--shiki-light-bg":"#fff","--shiki-dark-bg":"#24292e"},tabIndex:"0",icon:'<svg viewBox="0 0 24 24"><path d="m 4,4 a 1,1 0 0 0 -0.7070312,0.2929687 1,1 0 0 0 0,1.4140625 L 8.5859375,11 3.2929688,16.292969 a 1,1 0 0 0 0,1.414062 1,1 0 0 0 1.4140624,0 l 5.9999998,-6 a 1.0001,1.0001 0 0 0 0,-1.414062 L 4.7070312,4.2929687 A 1,1 0 0 0 4,4 Z m 8,14 a 1,1 0 0 0 -1,1 1,1 0 0 0 1,1 h 8 a 1,1 0 0 0 1,-1 1,1 0 0 0 -1,-1 z" fill="currentColor" /></svg>',children:e.jsxs(i.code,{children:[e.jsxs(i.span,{className:"line",children:[e.jsx(i.span,{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"},children:"auth_request_set"}),e.jsx(i.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:" $my_header $upstream_http_my_header;"})]}),`
`,e.jsxs(i.span,{className:"line",children:[e.jsx(i.span,{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"},children:"proxy_set_header"}),e.jsx(i.span,{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"},children:" my-header"}),e.jsx(i.span,{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"},children:" $my_header;"})]})]})})})]})}function c(s={}){const{wrapper:i}=s.components||{};return i?e.jsx(i,{...s,children:e.jsx(r,{...s})}):r(s)}function n(s,i){throw new Error("Expected component `"+s+"` to be defined: you likely forgot to import, pass, or provide it.")}export{c as default,d as extractedReferences,h as frontmatter,o as structuredData,l as toc};
