import{r as u}from"./chunk-ZMWYLUDP-oajMeTFk.js";import{c as m}from"./chunk-OTD7MV33-qJr9DjGl.js";async function x(h,g){const o=m(h),i=[],{index:d="default",client:l,params:n={},tag:c}=g;if(d==="crawler"){const s=await l.search({...n,term:h,where:{category:c?{eq:c.slice(0,1).toUpperCase()+c.slice(1)}:void 0,...n.where},limit:10});if(!s)return i;for(const r of s.hits){const e=r.document;i.push({id:r.id,type:"page",content:e.title,contentWithHighlights:o.highlight(e.title),url:e.path},{id:"page"+r.id,type:"text",content:e.content,contentWithHighlights:o.highlight(e.content),url:e.path})}return i}const p={...n,term:h,where:u({tag:c,...n.where}),groupBy:{properties:["page_id"],maxResult:7,...n.groupBy}},a=await l.search(p);if(!a||!a.groups)return i;for(const s of a.groups){let r=!1;for(const e of s.result){const t=e.document;r||(i.push({id:t.page_id,type:"page",content:t.title,breadcrumbs:t.breadcrumbs,contentWithHighlights:o.highlight(t.title),url:t.url}),r=!0),i.push({id:t.id,content:t.content,contentWithHighlights:o.highlight(t.content),type:t.content===t.section?"heading":"text",url:t.section_id?`${t.url}#${t.section_id}`:t.url})}}return i}export{x as searchDocs};
